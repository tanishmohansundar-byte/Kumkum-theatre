<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Kumkum Theatre Booking</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: white;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .screen {
      display: none;
      padding: 30px;
    }
    .active {
      display: block;
      animation: fadeIn 0.6s ease;
    }
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    h1, h2 {
      color: gold;
    }
    button {
      background-color: crimson;
      border: none;
      padding: 12px 24px;
      margin: 12px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      color: white;
    }
    button:hover {
      background-color: darkred;
    }
    input {
      margin: 10px;
      padding: 8px;
      font-size: 14px;
      border-radius: 6px;
      border: none;
    }
    .seat-grid {
      display: grid;
      grid-template-columns: repeat(8, 40px);
      grid-gap: 8px;
      justify-content: center;
      margin-top: 20px;
    }
    .seat {
      width: 40px;
      height: 40px;
      background: #666;
      border-radius: 5px;
      cursor: pointer;
      line-height: 40px;
    }
    .seat.selected {
      background: green;
      color: white;
    }
    .seat.premium {
      background: #9999ff;
    }
    .result-box {
      margin-top: 20px;
      padding: 15px;
      background: #222;
      border-radius: 10px;
      display: inline-block;
    }
    canvas {
      margin-top: 15px;
      background: white;
      padding: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>

  <!-- Welcome -->
  <div id="welcome" class="screen active">
    <h1>ðŸŽ¬ Welcome to Kumkum Theatre ðŸŽ¬</h1>
    <button onclick="goToScreen('movies')">Book Tickets</button>
  </div>

  <!-- Movies -->
  <div id="movies" class="screen">
    <h2>Select a Movie</h2>
    <button onclick="chooseMovie('JAI BHIM')">Jai Bhim</button>
    <button onclick="chooseMovie('DETECTIVE')">Detective</button>
    <button onclick="chooseMovie('NAIDUS PADAM')">Naidus Padam</button>
    <button onclick="chooseMovie('ULJADDI')">Uljaddi</button>
    <button onclick="chooseMovie('CHOKER')">Choker</button>
  </div>

  <!-- Customers + Date -->
  <div id="customerScreen" class="screen">
    <h2 id="selectedMovieTitle"></h2>
    <label>Select Date:</label><br>
    <input type="date" id="movieDate"><br>
    <label>Number of Customers:</label><br>
    <input type="number" id="numCustomers" min="1" max="10"><br>
    <button onclick="goToSeats()">Proceed to Seat Selection</button>
  </div>

  <!-- Seat Selection -->
  <div id="seatScreen" class="screen">
    <h2>Select Your Seats</h2>
    <div class="seat-grid" id="seatGrid"></div>
    <button onclick="confirmBooking()">Confirm Booking</button>
  </div>

  <!-- Confirmation -->
  <div id="confirmation" class="screen">
    <h2>Booking Confirmed âœ…</h2>
    <div id="ticketDetails" class="result-box"></div>
    <canvas id="qrcode"></canvas>
    <br>
    <button onclick="restartBooking()">Book Again</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/qrious/dist/qrious.min.js"></script>
  <script>
    let chosenMovie = "";
    let chosenShow = "";
    let chosenScreen = "";
    let numCustomers = 0;
    let selectedSeats = [];

    function goToScreen(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    function chooseMovie(movie) {
      chosenMovie = movie;
      let shows = "";
      if (movie === "ULJADDI") {
        chosenShow = "9:45 PM";
        chosenScreen = "Screen 4";
      } else if (movie === "CHOKER") {
        chosenShow = "10:20 PM";
        chosenScreen = "Screen 2";
      } else {
        chosenShow = "6:00 PM";
        chosenScreen = "Screen 1";
      }
      document.getElementById("selectedMovieTitle").innerText = 
        movie + " - " + chosenShow + " (" + chosenScreen + ")";
      goToScreen('customerScreen');
    }

    function goToSeats() {
      let date = document.getElementById('movieDate').value;
      numCustomers = parseInt(document.getElementById('numCustomers').value);

      if (!date || !numCustomers) {
        alert("Please select a date and number of customers.");
        return;
      }

      buildSeats();
      goToScreen('seatScreen');
    }

    function buildSeats() {
      const seatGrid = document.getElementById('seatGrid');
      seatGrid.innerHTML = "";
      selectedSeats = [];

      for (let r = 1; r <= 6; r++) {
        for (let c = 1; c <= 8; c++) {
          let seat = document.createElement("div");
          seat.classList.add("seat");
          seat.innerText = r + "" + c;
          if (r <= 2) seat.classList.add("premium");
          seat.onclick = () => toggleSeat(seat);
          seatGrid.appendChild(seat);
        }
      }
    }

    function toggleSeat(seat) {
      if (seat.classList.contains("selected")) {
        seat.classList.remove("selected");
        selectedSeats = selectedSeats.filter(s => s !== seat.innerText);
      } else {
        if (selectedSeats.length >= numCustomers) {
          alert("You can only select " + numCustomers + " seats.");
          return;
        }
        seat.classList.add("selected");
        selectedSeats.push(seat.innerText);
      }
    }

    function confirmBooking() {
      if (selectedSeats.length !== numCustomers) {
        alert("Please select " + numCustomers + " seats.");
        return;
      }

      let total = 0;
      selectedSeats.forEach(seat => {
        let row = parseInt(seat[0]);
        total += (row <= 2) ? 350 : 200;
      });

      let bookingInfo = `
        ðŸŽ¬ ${chosenMovie}
        ðŸ“… ${document.getElementById('movieDate').value}
        â° ${chosenShow} (${chosenScreen})
        ðŸ’º Seats: ${selectedSeats.join(", ")}
        ðŸŽŸ Tickets: ${numCustomers}
        ðŸ’° Total: â‚¹${total}
      `;

      document.getElementById("ticketDetails").innerHTML = bookingInfo.replace(/\n/g,"<br>");

      let qr = new QRious({
        element: document.getElementById('qrcode'),
        value: bookingInfo,
        size: 200
      });

      goToScreen('confirmation');
    }

    function restartBooking() {
      chosenMovie = "";
      chosenShow = "";
      chosenScreen = "";
      numCustomers = 0;
      selectedSeats = [];
      goToScreen('movies');
    }
  </script>

</body>
</html>
